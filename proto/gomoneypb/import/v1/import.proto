syntax = "proto3";

package gomoneypb.import.v1;

import "gomoneypb/transactions/v1/transactions.proto";

service ImportService {
  rpc ImportTransactions(ImportTransactionsRequest) returns (ImportTransactionsResponse) {}

  rpc ParseTransactions(ParseTransactionsRequest) returns (ParseTransactionsResponse) {}
}

message ParseTransactionsRequest {
  repeated string content = 1; // file or raw content depending on source
  ImportSource source = 2;
  bool treat_dates_as_utc = 4;
}

message ParseTransactionsResponse {
  repeated gomoneypb.transactions.v1.CreateTransactionRequest requests = 1;
}

message ImportTransactionsRequest {
  string file_content = 1; // base64 encoded content of the Firefly file
  ImportSource source = 2;
  bool skip_rules = 3;
  bool treat_dates_as_utc = 4;
}

message ImportTransactionsResponse {
  int32 imported_count = 1;
  int32 duplicate_count = 2;
}


enum ImportSource {
  IMPORT_SOURCE_UNSPECIFIED = 0;
  IMPORT_SOURCE_FIREFLY = 1;
  IMPORT_SOURCE_PRIVATE_24 = 2;
  IMPORT_SOURCE_REVOLUT = 3;
  IMPORT_SOURCE_MONOBANK = 4;
  IMPORT_SOURCE_BNP_PARIBAS_POLSKA = 5;
}
