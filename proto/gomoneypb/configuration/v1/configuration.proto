syntax = "proto3";

package gomoneypb.configuration.v1;

import "gomoneypb/v1/servicetoken.proto";
import "google/protobuf/timestamp.proto";

service ConfigurationService {
  rpc GetConfiguration(GetConfigurationRequest) returns (GetConfigurationResponse) {}
  rpc GetConfigsByKeys(GetConfigsByKeysRequest) returns (GetConfigsByKeysResponse) {}
  rpc SetConfigByKey(SetConfigByKeyRequest) returns (SetConfigByKeyResponse) {}
  
  rpc GetServiceTokens(GetServiceTokensRequest) returns (GetServiceTokensResponse) {}
  rpc CreateServiceToken(CreateServiceTokenRequest) returns (CreateServiceTokenResponse) {}
  rpc RevokeServiceToken(RevokeServiceTokenRequest) returns (RevokeServiceTokenResponse) {}
}

message RevokeServiceTokenRequest {
  int32 id = 1;
}

message RevokeServiceTokenResponse {
  int32 id = 1;
}

message GetServiceTokensRequest {
  repeated string ids = 1;
}

message GetServiceTokensResponse {
  repeated gomoneypb.v1.ServiceToken service_tokens = 1;
}

message CreateServiceTokenRequest {
  string name = 1;
  google.protobuf.Timestamp expires_at = 2;
}

message CreateServiceTokenResponse {
  gomoneypb.v1.ServiceToken service_token = 1;
  string token = 2;
}

message SetConfigByKeyRequest {
  string key = 1;
  string value = 2;
}

message SetConfigByKeyResponse {
  string key = 1;
}

message GetConfigsByKeysRequest {
  repeated string keys = 1;
}

message GetConfigsByKeysResponse {
  map<string, string> configs = 1;
}

message GetConfigurationRequest {}

message GetConfigurationResponse {
  bool should_create_admin = 1;
  string base_currency = 2;
  string grafana_url = 3;
  string backend_version = 4;
  string commit_sha = 5;
}
